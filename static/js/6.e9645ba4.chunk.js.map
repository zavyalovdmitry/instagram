{"version":3,"sources":["services/firebase.js","components/header.js","hooks/use-user.js","components/profile/header.js","components/profile/photos.js","components/profile/index.js","pages/profile.js"],"names":["doesUsernameExist","username","a","firebase","firestore","collection","where","get","result","docs","map","user","data","length","getUserByUsername","item","docId","id","getUserByUserId","userId","getSuggestedProfiles","following","limit","filter","profile","includes","updateLoggedInUserFollowing","loggedInUserDocId","profileId","isFollowingProfile","doc","update","FieldValue","arrayRemove","arrayUnion","updateFollowedUserFollowers","profileDocId","followers","getPhotos","userFollowedPhotos","photo","Promise","all","userLikedPhoto","likes","photosWithUserDetails","getUserPhotosByUsername","isUserFollowingProfile","loggedInUserUsername","profileUserId","response","toggleFollow","activeUserDocId","followingUserId","Header","useContext","FirebaseContext","UserContext","className","to","ROUTES","aria-label","src","alt","xmlns","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","type","title","onClick","auth","signOut","onKeyDown","event","key","displayName","useUser","useState","activeUser","setActiveUser","useEffect","uid","getUserObjByUserId","photosCount","followerCount","setFollowerCount","fullName","profileUsername","setIsFollowingProfile","activeBtnFollow","handleToggleFollow","isLoggedInUserFollowingProfile","isFollowing","console","log","undefined","count","width","height","Photos","photos","imageSrc","caption","fillRule","clipRule","comments","reducer","state","newState","initialState","photosCollection","Profile","useReducer","dispatch","getProfileInfoAndPhotos","useParams","setUser","history","useHistory","push","checkUserExists"],"mappings":"kfAEO,SAAeA,EAAtB,kC,4CAAO,WAAiCC,GAAjC,eAAAC,EAAA,sEACgBC,IAClBC,YACAC,WAAW,SACXC,MAAM,WAAY,KAAML,GACxBM,MALE,cACCC,EADD,yBAOEA,EAAOC,KAAKC,KAAI,SAACC,GAAD,OAAUA,EAAKC,OAAOC,OAAS,MAPjD,4C,sBAUA,SAAeC,EAAtB,kC,4CAAO,WAAiCb,GAAjC,eAAAC,EAAA,sEACgBC,IAClBC,YACAC,WAAW,SACXC,MAAM,WAAY,KAAML,GACxBM,MALE,cACCC,EADD,yBAOEA,EAAOC,KAAKC,KAAI,SAACK,GAAD,mBAAC,eACnBA,EAAKH,QADa,IAErBI,MAAOD,EAAKE,SATT,4C,sBAaA,SAAeC,EAAtB,kC,4CAAO,WAA+BC,GAA/B,iBAAAjB,EAAA,sEACgBC,IAASC,YAAYC,WAAW,SAASC,MAAM,SAAU,KAAMa,GAAQZ,MADvF,cACCC,EADD,OAECG,EAAOH,EAAOC,KAAKC,KAAI,SAACK,GAAD,mBAAC,eACzBA,EAAKH,QADmB,IAE3BI,MAAOD,EAAKE,QAJT,kBAMEN,GANF,4C,sBASA,SAAeS,EAAtB,oC,4CAAO,WAAoCD,EAAQE,GAA5C,eAAAnB,EAAA,sEACgBC,IAASC,YAAYC,WAAW,SAASiB,MAAM,IAAIf,MADnE,cACCC,EADD,yBAEEA,EAAOC,KACXC,KAAI,SAACC,GAAD,mBAAC,eAAeA,EAAKC,QAArB,IAA6BI,MAAOL,EAAKM,QAC7CM,QAAO,SAACC,GAAD,OAAaA,EAAQL,SAAWA,IAAWE,EAAUI,SAASD,EAAQL,YAJ3E,4C,sBAOA,SAAeO,EAAtB,sC,4CAAO,WACLC,EACAC,EACAC,GAHK,SAAA3B,EAAA,+EAKEC,IACJC,YACAC,WAAW,SACXyB,IAAIH,GACJI,OAAO,CACNV,UAAWQ,EACPG,IAAWC,YAAYL,GACvBI,IAAWE,WAAWN,MAZzB,4C,sBAgBA,SAAeO,EAAtB,sC,4CAAO,WACLC,EACAT,EACAE,GAHK,SAAA3B,EAAA,+EAKEC,IACJC,YACAC,WAAW,SACXyB,IAAIM,GACJL,OAAO,CACNM,UAAWR,EACPG,IAAWC,YAAYN,GACvBK,IAAWE,WAAWP,MAZzB,4C,sBAgBA,SAAeW,EAAtB,oC,4CAAO,WAAyBnB,EAAQE,GAAjC,mBAAAnB,EAAA,sEACgBC,IAClBC,YACAC,WAAW,UACXC,MAAM,SAAU,KAAMe,GACtBd,MALE,cACCC,EADD,OAOC+B,EAAqB/B,EAAOC,KAAKC,KAAI,SAAC8B,GAAD,mBAAC,eACvCA,EAAM5B,QADgC,IAEzCI,MAAOwB,EAAMvB,QATV,SAY+BwB,QAAQC,IAC1CH,EAAmB7B,IAAnB,uCAAuB,WAAO8B,GAAP,mBAAAtC,EAAA,6DACjByC,GAAiB,EACjBH,EAAMI,MAAMnB,SAASN,KACvBwB,GAAiB,GAHE,SAKFzB,EAAgBsB,EAAMrB,QALpB,cAKfR,EALe,OAMbV,EAAaU,EAAK,GAAlBV,SANa,2CAOZA,YAAauC,GAPD,IAOQG,oBAPR,2CAAvB,wDAbG,cAYCE,EAZD,yBAwBEA,GAxBF,4C,sBA2BA,SAAeC,EAAtB,kC,4CAAO,WAAuC7C,GAAvC,qBAAAC,EAAA,sEACgBY,EAAkBb,GADlC,0CACEU,EADF,cAEgBR,IAClBC,YACAC,WAAW,UACXC,MAAM,SAAU,KAAMK,EAAKQ,QAC3BZ,MANE,cAECC,EAFD,yBAOEA,EAAOC,KAAKC,KAAI,SAACK,GAAD,mBAAC,eACnBA,EAAKH,QADa,IAErBI,MAAOD,EAAKE,SATT,4C,sBAaA,SAAe8B,EAAtB,oC,4CAAO,WAAsCC,EAAsBC,GAA5D,uBAAA/C,EAAA,sEACgBC,IAClBC,YACAC,WAAW,SACXC,MAAM,WAAY,KAAM0C,GACxB1C,MAAM,YAAa,iBAAkB2C,GACrC1C,MANE,cACCC,EADD,SAQmBA,EAAOC,KAAKC,KAAI,SAACK,GAAD,mBAAC,eACpCA,EAAKH,QAD8B,IAEtCI,MAAOD,EAAKE,QAVT,0BAQEiC,OARF,MAQa,GARb,oBAaEA,EAAS/B,QAbX,4C,sBAgBA,SAAegC,EAAtB,0C,4CAAO,WACLtB,EACAuB,EACAhB,EACAa,EACAI,GALK,SAAAnD,EAAA,sEAOCwB,EAA4B0B,EAAiBH,EAAepB,GAP7D,uBAQCM,EAA4BC,EAAciB,EAAiBxB,GAR5D,4C,wDCjIP,oFAMe,SAASyB,IACtB,IAAQnD,EAAaoD,qBAAWC,KAAxBrD,SACAQ,EAAS4C,qBAAWE,KAApB9C,KAER,OACE,wBAAQ+C,UAAU,kDAAlB,SACE,qBAAKA,UAAU,2CAAf,SACE,sBAAKA,UAAU,8BAAf,UACE,qBAAKA,UAAU,yEAAf,SACE,oBAAIA,UAAU,6BAAd,SACE,cAAC,IAAD,CAAMC,GAAIC,IAAkBC,aAAW,kBAAvC,SACE,qBAAKC,IAAI,mBAAmBC,IAAI,aAAaL,UAAU,sBAI7D,qBAAKA,UAAU,0DAAf,SACG/C,EACC,qCACE,cAAC,IAAD,CAAMgD,GAAIC,IAAkBC,aAAW,YAAvC,SACE,qBACEH,UAAU,2CACVM,MAAM,6BACNC,KAAK,OACLC,QAAQ,YACRC,OAAO,eALT,SAOE,sBACEC,cAAc,QACdC,eAAe,QACfC,YAAa,EACbC,EAAE,yJAIR,wBACEC,KAAK,SACLC,MAAM,WACNC,QAAS,kBAAMvE,EAASwE,OAAOC,WAC/BC,UAAW,SAACC,GACQ,UAAdA,EAAMC,KACR5E,EAASwE,OAAOC,WANtB,SAUE,qBACElB,UAAU,2CACVM,MAAM,6BACNC,KAAK,OACLC,QAAQ,YACRC,OAAO,eALT,SAOE,sBACEC,cAAc,QACdC,eAAe,QACfC,YAAa,EACbC,EAAE,kGAIR,qBAAKb,UAAU,mCAAf,SACE,cAAC,IAAD,CAAMC,GAAE,aAAQhD,EAAKqE,aAArB,SACE,qBACEtB,UAAU,4BACVI,IAAG,0BAAqBnD,EAAKqE,YAA1B,QACHjB,IAAG,UAAKpD,EAAKqE,YAAV,qBAMX,qCACE,cAAC,IAAD,CAAMrB,GAAIC,IAAV,SACE,wBACEY,KAAK,SACLd,UAAU,+DAFZ,sBAOF,cAAC,IAAD,CAAMC,GAAIC,IAAV,SACE,wBACEY,KAAK,SACLd,UAAU,sDAFZ,qC,8HClFH,SAASuB,IACtB,MAAoCC,mBAAS,IAA7C,mBAAOC,EAAP,KAAmBC,EAAnB,KACQzE,EAAS4C,qBAAWE,KAApB9C,KAaR,OAXA0E,qBAAU,WAAM,4CACd,gCAAAnF,EAAA,sEAC2BgB,YAAgBP,EAAK2E,KADhD,mCACSpC,EADT,KAEEkC,EAAclC,GAFhB,4CADc,uBAMd,OAAIvC,QAAJ,IAAIA,OAAJ,EAAIA,EAAM2E,MANK,WAAD,wBAOZC,KAED,CAAC5E,IAEG,CAAEA,KAAMwE,K,kMCbF,SAAS7B,EAAT,GAYX,IAXFkC,EAWC,EAXDA,YACAC,EAUC,EAVDA,cACAC,EASC,EATDA,iBASC,IARDlE,QACSY,EAOR,EAPCpB,MACQiC,EAMT,EANC9B,OACAwE,EAKD,EALCA,SAKD,IAJCtD,iBAID,MAJa,GAIb,MAHChB,iBAGD,MAHa,GAGb,EAFWuE,EAEX,EAFC3F,SAGMU,EAASsE,cAATtE,KACR,EAAoDuE,oBAAS,GAA7D,mBAAOrD,EAAP,KAA2BgE,EAA3B,KACMC,EAAkBnF,EAAKV,UAAYU,EAAKV,WAAa2F,EAErDG,EAAkB,uCAAG,sBAAA7F,EAAA,6DACzB2F,GAAsB,SAAChE,GAAD,OAAyBA,KAC/C6D,EAAiB,CACfD,cAAe5D,EAAqB4D,EAAgB,EAAIA,EAAgB,IAHjD,SAMnBtC,YAAatB,EAAoBlB,EAAKK,MAAOoB,EAAca,EAAetC,EAAKQ,QAN5D,2CAAH,qDAoBxB,OAXAkE,qBAAU,WACR,IAAMW,EAA8B,uCAAG,4BAAA9F,EAAA,sEACX6C,YAAuBpC,EAAKV,SAAUgD,GAD3B,OAC/BgD,EAD+B,OAErCJ,IAAwBI,GAFa,2CAAH,qDAIpCC,QAAQC,IAAI,qBAAsBV,GAC9B9E,EAAKV,UAAYgD,GACnB+C,MAED,CAACrF,EAAKV,SAAUgD,IAGjB,sBAAKS,UAAU,iEAAf,UACE,qBAAKA,UAAU,gCAAf,SACGkC,GACC,qBACElC,UAAU,8BACVK,IAAG,UAAK6B,EAAL,YACH9B,IAAG,0BAAqB8B,EAArB,YAIT,sBAAKlC,UAAU,uDAAf,UACE,sBAAKA,UAAU,8BAAf,UACE,mBAAGA,UAAU,gBAAb,SAA8BkC,IAC7BE,GACC,wBACEpC,UAAU,kFACVc,KAAK,SACLE,QAASqB,EACTlB,UAAW,SAACC,GACQ,UAAdA,EAAMC,KACRgB,KANN,SAUGlE,EAAqB,WAAa,cAIzC,qBAAK6B,UAAU,sBAAf,cACiB0C,IAAd/D,QAAyC+D,IAAd/E,EAC1B,cAAC,IAAD,CAAUgF,MAAO,EAAGC,MAAO,IAAKC,OAAQ,KAExC,qCACE,oBAAG7C,UAAU,QAAb,UACE,sBAAMA,UAAU,YAAhB,SAA6B8B,IAD/B,IAGG,YAEH,oBAAG9B,UAAU,QAAb,UACE,sBAAMA,UAAU,YAAhB,SAA6B+B,IAD/B,IAGqB,IAAlBA,EAAA,0BAEH,oBAAG/B,UAAU,QAAb,UACE,sBAAMA,UAAU,YAAhB,SAA6BrC,EAAUR,SADzC,wBAON,qBAAK6C,UAAU,iBAAf,SACE,mBAAGA,UAAU,cAAb,SAA6BiC,GAAW,cAAC,IAAD,CAAUU,MAAO,EAAGE,OAAQ,eC5F/D,SAASC,EAAT,GAA6B,IAAXC,EAAU,EAAVA,OAC/B,OACE,sBAAK/C,UAAU,+CAAf,UACE,qBAAKA,UAAU,oCAAf,SACI+C,EAIEA,EAAO5F,OAAS,EAClB4F,EAAO/F,KAAI,SAAC8B,GAAD,OACT,sBAAuBkB,UAAU,iBAAjC,UACE,qBAAKI,IAAKtB,EAAMkE,SAAU3C,IAAKvB,EAAMmE,UACrC,sBAAKjD,UAAU,6HAAf,UACE,oBAAGA,UAAU,yCAAb,UACE,qBACEM,MAAM,6BACNE,QAAQ,YACRD,KAAK,eACLP,UAAU,WAJZ,SAME,sBACEkD,SAAS,UACTrC,EAAE,gHACFsC,SAAS,cAGZrE,EAAMI,MAAM/B,UAEf,oBAAG6C,UAAU,yCAAb,UACE,qBACEM,MAAM,6BACNE,QAAQ,YACRD,KAAK,eACLP,UAAU,WAJZ,SAME,sBACEkD,SAAS,UACTrC,EAAE,6KACFsC,SAAS,cAGZrE,EAAMsE,SAASjG,eA/BZ2B,EAAMxB,UAoChB,KAzCF,mCACE,cAAC,IAAD,CAAUqF,MAAO,GAAIC,MAAO,IAAKC,OAAQ,WA0C7CE,GAA6B,IAAlBA,EAAO5F,QAAgB,mBAAG6C,UAAU,uBAAb,gCC7C1C,IAAMqD,EAAU,SAACC,EAAOC,GAAR,mBAAC,eAA0BD,GAAUC,IAC/CC,EAAe,CACnB1F,QAAS,GACT2F,iBAAkB,KAClB1B,cAAe,GAGF,SAAS2B,EAAT,GAA4B,IAATzG,EAAQ,EAARA,KAChC,EAAiE0G,qBAC/DN,EACAG,GAFF,0BAAS1F,EAAT,EAASA,QAAS2F,EAAlB,EAAkBA,iBAAkB1B,EAApC,EAAoCA,cAAiB6B,EAArD,KAaA,OARAjC,qBAAU,WAAM,4CACd,4BAAAnF,EAAA,sEACuB4C,YAAwBnC,EAAKV,UADpD,OACQwG,EADR,OAEEa,EAAS,CAAE9F,QAASb,EAAMwG,iBAAkBV,EAAQhB,cAAe9E,EAAK0B,UAAUxB,SAFpF,4CADc,uBAAC,WAAD,wBAKd0G,KACC,CAAC5G,EAAKV,WAGP,qCACE,cAACqD,EAAD,CACEkC,YAAa2B,EAAmBA,EAAiBtG,OAAS,EAC1DW,QAASA,EACTiE,cAAeA,EACfC,iBAAkB4B,IAEpB,cAACd,EAAD,CAAQC,OAAQU,OC5BP,SAASC,IACtB,IAAQnH,EAAauH,cAAbvH,SACR,EAAwBiF,mBAAS,MAAjC,mBAAOvE,EAAP,KAAa8G,EAAb,KACMC,EAAUC,cAehB,OAbAtC,qBAAU,WAAM,4CACd,4BAAAnF,EAAA,sEACqBY,YAAkBb,GADvC,QACQU,EADR,QAEWE,OAAS,EAChB4G,EAAQ9G,EAAK,IAEb+G,EAAQE,KAAKhE,KALjB,4CADc,uBAAC,WAAD,wBAUdiE,KACC,CAAC5H,EAAUyH,KAEH,OAAJ/G,QAAI,IAAJA,OAAA,EAAAA,EAAMV,UACX,sBAAKyD,UAAU,qBAAf,UACE,cAAC,IAAD,IACA,qBAAKA,UAAU,0BAAf,SACE,cAAC,EAAD,CAAa/C,KAAMA,SAGrB","file":"static/js/6.e9645ba4.chunk.js","sourcesContent":["import { firebase, FieldValue } from '../lib/firebase';\r\n\r\nexport async function doesUsernameExist(username) {\r\n  const result = await firebase\r\n    .firestore()\r\n    .collection('users')\r\n    .where('username', '==', username)\r\n    .get();\r\n\r\n  return result.docs.map((user) => user.data().length > 0);\r\n}\r\n\r\nexport async function getUserByUsername(username) {\r\n  const result = await firebase\r\n    .firestore()\r\n    .collection('users')\r\n    .where('username', '==', username)\r\n    .get();\r\n\r\n  return result.docs.map((item) => ({\r\n    ...item.data(),\r\n    docId: item.id\r\n  }));\r\n}\r\n\r\nexport async function getUserByUserId(userId) {\r\n  const result = await firebase.firestore().collection('users').where('userId', '==', userId).get();\r\n  const user = result.docs.map((item) => ({\r\n    ...item.data(),\r\n    docId: item.id\r\n  }));\r\n  return user;\r\n}\r\n\r\nexport async function getSuggestedProfiles(userId, following) {\r\n  const result = await firebase.firestore().collection('users').limit(10).get();\r\n  return result.docs\r\n    .map((user) => ({ ...user.data(), docId: user.id }))\r\n    .filter((profile) => profile.userId !== userId && !following.includes(profile.userId));\r\n}\r\n\r\nexport async function updateLoggedInUserFollowing(\r\n  loggedInUserDocId,\r\n  profileId,\r\n  isFollowingProfile\r\n) {\r\n  return firebase\r\n    .firestore()\r\n    .collection('users')\r\n    .doc(loggedInUserDocId)\r\n    .update({\r\n      following: isFollowingProfile\r\n        ? FieldValue.arrayRemove(profileId)\r\n        : FieldValue.arrayUnion(profileId)\r\n    });\r\n}\r\n\r\nexport async function updateFollowedUserFollowers(\r\n  profileDocId,\r\n  loggedInUserDocId,\r\n  isFollowingProfile\r\n) {\r\n  return firebase\r\n    .firestore()\r\n    .collection('users')\r\n    .doc(profileDocId)\r\n    .update({\r\n      followers: isFollowingProfile\r\n        ? FieldValue.arrayRemove(loggedInUserDocId)\r\n        : FieldValue.arrayUnion(loggedInUserDocId)\r\n    });\r\n}\r\n\r\nexport async function getPhotos(userId, following) {\r\n  const result = await firebase\r\n    .firestore()\r\n    .collection('photos')\r\n    .where('userId', 'in', following)\r\n    .get();\r\n\r\n  const userFollowedPhotos = result.docs.map((photo) => ({\r\n    ...photo.data(),\r\n    docId: photo.id\r\n  }));\r\n\r\n  const photosWithUserDetails = await Promise.all(\r\n    userFollowedPhotos.map(async (photo) => {\r\n      let userLikedPhoto = false;\r\n      if (photo.likes.includes(userId)) {\r\n        userLikedPhoto = true;\r\n      }\r\n      const user = await getUserByUserId(photo.userId);\r\n      const { username } = user[0];\r\n      return { username, ...photo, userLikedPhoto };\r\n    })\r\n  );\r\n\r\n  return photosWithUserDetails;\r\n}\r\n\r\nexport async function getUserPhotosByUsername(username) {\r\n  const [user] = await getUserByUsername(username);\r\n  const result = await firebase\r\n    .firestore()\r\n    .collection('photos')\r\n    .where('userId', '==', user.userId)\r\n    .get();\r\n  return result.docs.map((item) => ({\r\n    ...item.data(),\r\n    docId: item.id\r\n  }));\r\n}\r\n\r\nexport async function isUserFollowingProfile(loggedInUserUsername, profileUserId) {\r\n  const result = await firebase\r\n    .firestore()\r\n    .collection('users')\r\n    .where('username', '==', loggedInUserUsername)\r\n    .where('following', 'array-contains', profileUserId)\r\n    .get();\r\n\r\n  const [response = {}] = result.docs.map((item) => ({\r\n    ...item.data(),\r\n    docId: item.id\r\n  }));\r\n\r\n  return response.userId;\r\n}\r\n\r\nexport async function toggleFollow(\r\n  isFollowingProfile,\r\n  activeUserDocId,\r\n  profileDocId,\r\n  profileUserId,\r\n  followingUserId\r\n) {\r\n  await updateLoggedInUserFollowing(activeUserDocId, profileUserId, isFollowingProfile);\r\n  await updateFollowedUserFollowers(profileDocId, followingUserId, isFollowingProfile);\r\n}\r\n","import { useContext } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport FirebaseContext from '../context/firebase';\r\nimport UserContext from '../context/user';\r\nimport * as ROUTES from '../constants/routes';\r\n\r\nexport default function Header() {\r\n  const { firebase } = useContext(FirebaseContext);\r\n  const { user } = useContext(UserContext);\r\n\r\n  return (\r\n    <header className=\"h-16 bg-white border-b border-gray-primary mb-8\">\r\n      <div className=\"container mx-auto max-w-screen-lg h-full\">\r\n        <div className=\"flex justify-between h-full\">\r\n          <div className=\"text-gray-700 text-center flex items-center align-items cursor-pointer\">\r\n            <h1 className=\"flex justify-center w-full\">\r\n              <Link to={ROUTES.DASHBOARD} aria-label=\"Zinstagram logo\">\r\n                <img src=\"/images/logo.png\" alt=\"Zinstagram\" className=\"mt-2 w-6/12\" />\r\n              </Link>\r\n            </h1>\r\n          </div>\r\n          <div className=\"text-gray-700 text-center flex items-center align-items\">\r\n            {user ? (\r\n              <>\r\n                <Link to={ROUTES.DASHBOARD} aria-label=\"Dashboard\">\r\n                  <svg\r\n                    className=\"w-8 mr-6 text-black-light cursor-pointer\"\r\n                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                    fill=\"none\"\r\n                    viewBox=\"0 0 24 24\"\r\n                    stroke=\"currentColor\"\r\n                  >\r\n                    <path\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                      strokeWidth={2}\r\n                      d=\"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6\"\r\n                    />\r\n                  </svg>\r\n                </Link>\r\n                <button\r\n                  type=\"button\"\r\n                  title=\"Sign Out\"\r\n                  onClick={() => firebase.auth().signOut()}\r\n                  onKeyDown={(event) => {\r\n                    if (event.key === 'Enter') {\r\n                      firebase.auth().signOut();\r\n                    }\r\n                  }}\r\n                >\r\n                  <svg\r\n                    className=\"w-8 mr-6 text-black-light cursor-pointer\"\r\n                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                    fill=\"none\"\r\n                    viewBox=\"0 0 24 24\"\r\n                    stroke=\"currentColor\"\r\n                  >\r\n                    <path\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                      strokeWidth={2}\r\n                      d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\"\r\n                    />\r\n                  </svg>\r\n                </button>\r\n                <div className=\"flex items-center cursor-pointer\">\r\n                  <Link to={`/p/${user.displayName}`}>\r\n                    <img\r\n                      className=\"rounded-full h-8 w-8 flex\"\r\n                      src={`/images/avatars/${user.displayName}.jpg`}\r\n                      alt={`${user.displayName} profile`}\r\n                    />\r\n                  </Link>\r\n                </div>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Link to={ROUTES.LOGIN}>\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"bg-blue-medium font-bold text-sm rounded text-white w-20 h-8\"\r\n                  >\r\n                    Log In\r\n                  </button>\r\n                </Link>\r\n                <Link to={ROUTES.SIGN_UP}>\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"font-bold text-sm rounded text-blue-medium w-20 h-8\"\r\n                  >\r\n                    Sign Up\r\n                  </button>\r\n                </Link>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </header>\r\n  );\r\n}\r\n","import { useState, useEffect, useContext } from 'react';\r\nimport UserContext from '../context/user';\r\nimport { getUserByUserId } from '../services/firebase';\r\n\r\nexport default function useUser() {\r\n  const [activeUser, setActiveUser] = useState({});\r\n  const { user } = useContext(UserContext);\r\n\r\n  useEffect(() => {\r\n    async function getUserObjByUserId() {\r\n      const [response] = await getUserByUserId(user.uid);\r\n      setActiveUser(response);\r\n    }\r\n\r\n    if (user?.uid) {\r\n      getUserObjByUserId();\r\n    }\r\n  }, [user]);\r\n\r\n  return { user: activeUser };\r\n}\r\n","import { useState, useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Skeleton from 'react-loading-skeleton';\r\nimport useUser from '../../hooks/use-user';\r\nimport { isUserFollowingProfile, toggleFollow } from '../../services/firebase';\r\n\r\nexport default function Header({\r\n  photosCount,\r\n  followerCount,\r\n  setFollowerCount,\r\n  profile: {\r\n    docId: profileDocId,\r\n    userId: profileUserId,\r\n    fullName,\r\n    followers = [],\r\n    following = [],\r\n    username: profileUsername\r\n  }\r\n}) {\r\n  const { user } = useUser();\r\n  const [isFollowingProfile, setIsFollowingProfile] = useState(false);\r\n  const activeBtnFollow = user.username && user.username !== profileUsername;\r\n\r\n  const handleToggleFollow = async () => {\r\n    setIsFollowingProfile((isFollowingProfile) => !isFollowingProfile);\r\n    setFollowerCount({\r\n      followerCount: isFollowingProfile ? followerCount - 1 : followerCount + 1\r\n    });\r\n\r\n    await toggleFollow(isFollowingProfile, user.docId, profileDocId, profileUserId, user.userId);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const isLoggedInUserFollowingProfile = async () => {\r\n      const isFollowing = await isUserFollowingProfile(user.username, profileUserId);\r\n      setIsFollowingProfile(!!isFollowing);\r\n    };\r\n    console.log('init followerCount', followerCount);\r\n    if (user.username && profileUserId) {\r\n      isLoggedInUserFollowingProfile();\r\n    }\r\n  }, [user.username, profileUserId]);\r\n\r\n  return (\r\n    <div className=\"grid grid-cols-3 gap-4 justify-between mx-auto max-w-screen-lg\">\r\n      <div className=\"container flex justify-center\">\r\n        {profileUsername && (\r\n          <img\r\n            className=\"rounded-full h-40 w-40 flex\"\r\n            alt={`${profileUsername} profile`}\r\n            src={`/images/avatars/${profileUsername}.jpg`}\r\n          />\r\n        )}\r\n      </div>\r\n      <div className=\"flex items-center justify-center flex-col col-span-2\">\r\n        <div className=\"container flex items-canter\">\r\n          <p className=\"text-2xl mr-4\">{profileUsername}</p>\r\n          {activeBtnFollow && (\r\n            <button\r\n              className=\"bg-blue-medium font-bold text-sm rounded text-white w-20 h-8 focus:outline-none\"\r\n              type=\"button\"\r\n              onClick={handleToggleFollow}\r\n              onKeyDown={(event) => {\r\n                if (event.key === 'Enter') {\r\n                  handleToggleFollow();\r\n                }\r\n              }}\r\n            >\r\n              {isFollowingProfile ? 'Unfollow' : 'Follow'}\r\n            </button>\r\n          )}\r\n        </div>\r\n        <div className=\"container flex mt-4\">\r\n          {followers === undefined || following === undefined ? (\r\n            <Skeleton count={1} width={677} height={24} />\r\n          ) : (\r\n            <>\r\n              <p className=\"mr-10\">\r\n                <span className=\"font-bold\">{photosCount}</span>\r\n                {` `}\r\n                {photosCount === 1 ? `photos` : `photos`}\r\n              </p>\r\n              <p className=\"mr-10\">\r\n                <span className=\"font-bold\">{followerCount}</span>\r\n                {` `}\r\n                {followerCount === 1 ? `follower` : `followers`}\r\n              </p>\r\n              <p className=\"mr-10\">\r\n                <span className=\"font-bold\">{following.length}</span>\r\n                {` `}following\r\n              </p>\r\n            </>\r\n          )}\r\n        </div>\r\n        <div className=\"container mt-4\">\r\n          <p className=\"font-medium\">{!fullName ? <Skeleton count={1} height={24} /> : fullName}</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nHeader.propTypes = {\r\n  photosCount: PropTypes.number.isRequired,\r\n  followerCount: PropTypes.number.isRequired,\r\n  setFollowerCount: PropTypes.func.isRequired,\r\n  profile: PropTypes.shape({\r\n    docId: PropTypes.string,\r\n    userId: PropTypes.string,\r\n    fullName: PropTypes.string,\r\n    followers: PropTypes.array,\r\n    following: PropTypes.array,\r\n    username: PropTypes.string\r\n  }).isRequired\r\n};\r\n","import PropTypes from 'prop-types';\r\nimport Skeleton from 'react-loading-skeleton';\r\n\r\nexport default function Photos({ photos }) {\r\n  return (\r\n    <div className=\"h-16 border-t border-gray-primary mt-12 pt-4\">\r\n      <div className=\"grid grid-cols-3 gap-8 mt-4 mb-12\">\r\n        {!photos ? (\r\n          <>\r\n            <Skeleton count={12} width={320} height={400} />\r\n          </>\r\n        ) : photos.length > 0 ? (\r\n          photos.map((photo) => (\r\n            <div key={photo.docId} className=\"relative group\">\r\n              <img src={photo.imageSrc} alt={photo.caption} />\r\n              <div className=\"absolute bottom-0 left-0 bg-gray-200 z-10 w-full justify-evenly items-center h-full bg-black-faded group-hover:flex hidden\">\r\n                <p className=\"flex items-center text-white font-bold\">\r\n                  <svg\r\n                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                    viewBox=\"0 0 20 20\"\r\n                    fill=\"currentColor\"\r\n                    className=\"w-8 mr-4\"\r\n                  >\r\n                    <path\r\n                      fillRule=\"evenodd\"\r\n                      d=\"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z\"\r\n                      clipRule=\"evenodd\"\r\n                    />\r\n                  </svg>\r\n                  {photo.likes.length}\r\n                </p>\r\n                <p className=\"flex items-center text-white font-bold\">\r\n                  <svg\r\n                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                    viewBox=\"0 0 20 20\"\r\n                    fill=\"currentColor\"\r\n                    className=\"w-8 mr-4\"\r\n                  >\r\n                    <path\r\n                      fillRule=\"evenodd\"\r\n                      d=\"M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z\"\r\n                      clipRule=\"evenodd\"\r\n                    />\r\n                  </svg>\r\n                  {photo.comments.length}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          ))\r\n        ) : null}\r\n      </div>\r\n      {!photos || (photos.length === 0 && <p className=\"text-center text-2xl\">No posts yet ;(</p>)}\r\n    </div>\r\n  );\r\n}\r\n\r\nPhotos.propTypes = {\r\n  photos: PropTypes.array.isRequired\r\n};\r\n","import { useReducer, useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Header from './header';\r\nimport Photos from './photos';\r\nimport { getUserPhotosByUsername } from '../../services/firebase';\r\n\r\nconst reducer = (state, newState) => ({ ...state, ...newState });\r\nconst initialState = {\r\n  profile: {},\r\n  photosCollection: null,\r\n  followerCount: 0\r\n};\r\n\r\nexport default function Profile({ user }) {\r\n  const [{ profile, photosCollection, followerCount }, dispatch] = useReducer(\r\n    reducer,\r\n    initialState\r\n  );\r\n\r\n  useEffect(() => {\r\n    async function getProfileInfoAndPhotos() {\r\n      const photos = await getUserPhotosByUsername(user.username);\r\n      dispatch({ profile: user, photosCollection: photos, followerCount: user.followers.length });\r\n    }\r\n    getProfileInfoAndPhotos();\r\n  }, [user.username]);\r\n\r\n  return (\r\n    <>\r\n      <Header\r\n        photosCount={photosCollection ? photosCollection.length : 0}\r\n        profile={profile}\r\n        followerCount={followerCount}\r\n        setFollowerCount={dispatch}\r\n      />\r\n      <Photos photos={photosCollection} />\r\n    </>\r\n  );\r\n}\r\n\r\nProfile.propTypes = {\r\n  user: PropTypes.shape({\r\n    dateCreated: PropTypes.number.isRequired,\r\n    emailAddress: PropTypes.string.isRequired,\r\n    followers: PropTypes.array.isRequired,\r\n    following: PropTypes.array.isRequired,\r\n    fullName: PropTypes.string.isRequired,\r\n    userId: PropTypes.string.isRequired,\r\n    username: PropTypes.string.isRequired\r\n  })\r\n};\r\n","import { useEffect, useState } from 'react';\r\nimport { useParams, useHistory } from 'react-router-dom';\r\nimport { getUserByUsername } from '../services/firebase';\r\nimport * as ROUTES from '../constants/routes';\r\nimport Header from '../components/header';\r\nimport UserProfile from '../components/profile';\r\n\r\nexport default function Profile() {\r\n  const { username } = useParams();\r\n  const [user, setUser] = useState(null);\r\n  const history = useHistory();\r\n\r\n  useEffect(() => {\r\n    async function checkUserExists() {\r\n      const user = await getUserByUsername(username);\r\n      if (user.length > 0) {\r\n        setUser(user[0]);\r\n      } else {\r\n        history.push(ROUTES.NOT_FOUND);\r\n      }\r\n    }\r\n\r\n    checkUserExists();\r\n  }, [username, history]);\r\n\r\n  return user?.username ? (\r\n    <div className=\"bg-gray-background\">\r\n      <Header />\r\n      <div className=\"mx-auto max-w-screen-lg\">\r\n        <UserProfile user={user} />\r\n      </div>\r\n    </div>\r\n  ) : null;\r\n}\r\n"],"sourceRoot":""}